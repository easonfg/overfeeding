source('~/Desktop/overfeeding/metabolomics_FC/volcano_plots.R')
source('~/Desktop/overfeeding/metabolomics_FC/volcano_plots.R')
dev.off()
overfeed.data
pheno.data
head(pheno.data)
overfeed.data
head(overfeed.data)
overfeed.data[1:10,1:10]
overfeed.data[1:3,1:10]
unique(overfeed.data$GROUP.NAME)
source('~/Desktop/overfeeding/metabolomics_FC/volcano_plots_grouped.R')
unique(overfeed.data$GROUP.NAME)
source('~/Desktop/overfeeding/metabolomics_FC/volcano_plots_grouped.R')
pipe(2, 'Insulin Sensitive', 'padj')
pipe(4, 'Insulin Sensitive', 'padj')
pipe(8, 'Insulin Sensitive', 'padj')
pipe(2, 'Insulin Sensitive', 'p.val')
pipe(4, 'Insulin Sensitive', 'p.val')
pipe(8, 'Insulin Sensitive', 'p.val')
pipe(2, 'Insulin Resistance', 'padj')
pipe(4, 'Insulin Resistance', 'padj')
pipe(8, 'Insulin Resistance', 'padj')
pipe(2, 'Insulin Resistance', 'p.val')
pipe(4, 'Insulin Resistance', 'p.val')
pipe(8, 'Insulin Resistance', 'p.val')
pipe(2, 'Intermediate', 'padj')
data1
overfeed.data
overfeed.data[1:10,1:10]
scale(c(1,1,1,1,1,9,9,9,9,9))
scale(c(1,1,1,1,1,90,90,90,90,90))
debugSource('~/Desktop/overfeeding/metabolomics_FC/volcano_plots.R')
data1
debugSource('~/Desktop/overfeeding/metabolomics_FC/log_univariate.R')
debugSource('~/Desktop/overfeeding/metabolomics_FC/log_univariate.R')
debugSource('~/Desktop/overfeeding/metabolomics_FC/log_univariate.R')
logitMod2
x
paste('TIME.POINT~ AGE + BMI + GENDER + GROUP.NAME + ', x)
summary(logitMod2)
summary(logitMod2)
summary(logitMod2)$coefficients
logit.summary[7,4]
logit.summary = summary(logitMod2)$coefficients
logit.summary[7,4]
debugSource('~/Desktop/overfeeding/metabolomics_FC/log_univariate.R')
debugSource('~/Desktop/overfeeding/metabolomics_FC/log_univariate.R')
debugSource('~/Desktop/overfeeding/metabolomics_FC/log_univariate.R')
logitMod2 <- glm(as.formula(paste('TIME.POINT~ AGE + BMI + GENDER + GROUP.NAME + X3..cystein.S.yl.acetaminophen.', )),
data=comb.data, family=binomial(link="logit"))
logitMod2 <- glm(as.formula(paste('TIME.POINT~ AGE + BMI + GENDER + GROUP.NAME + X3..cystein.S.yl.acetaminophen.' )),
data=comb.data, family=binomial(link="logit"))
summary(logitMod2)
debugSource('~/Desktop/overfeeding/metabolomics_FC/log_univariate.R')
debugSource('~/Desktop/overfeeding/metabolomics_FC/log_univariate.R')
debugSource('~/Desktop/overfeeding/metabolomics_FC/log_univariate.R')
debugSource('~/Desktop/overfeeding/metabolomics_FC/log_univariate.R')
debugSource('~/Desktop/overfeeding/metabolomics_FC/log_univariate.R')
logitMod2[7,4]
logitMod2[7,3]
logitMod2[6,4]
summary(logitMod2)[7,4]
summary(logitMod2)[3,4]
summary(logitMod2)coefficients[6,4]
summary(logitMod2)$coefficients[6,4]
summary(logitMod2)$coefficients[7,4]
dim(summary(logitMod2)$coefficients)
debugSource('~/Desktop/overfeeding/metabolomics_FC/log_univariate.R')
debugSource('~/Desktop/overfeeding/metabolomics_FC/log_univariate.R')
res
res[1:10,1:2]
debugSource('~/Desktop/overfeeding/metabolomics_FC/log_univariate.R')
res
unlist(res)
dim(unlist(res))
unlist(res)
res
t(res)
dim(t(res))
res
data.frame(res)
matrix(unlist(res))
dim(matrix(unlist(res)))
do.call(rbind, res)
debugSource('~/Desktop/overfeeding/metabolomics_FC/log_univariate.R')
str(res)
dim(res)
res
head(res)
res$lrtest.padj = p.adjust(res$lrtest, method = 'BH')
res$summary.padj = p.adjust(res$summary, method = 'BH')
res = data.frame(res)
debugSource('~/Desktop/overfeeding/metabolomics_FC/log_univariate.R')
res$lrtest.padj = p.adjust(res$lrtest, method = 'BH')
res$summary.padj = p.adjust(res$summary, method = 'BH')
res[which(res$lrtest.padj < 1),]
debugSource('~/Desktop/overfeeding/metabolomics_FC/log_univariate.R')
res
res
head(res)
res$summary
debugSource('~/Desktop/overfeeding/metabolomics_FC/log_univariate.R')
res
head(fdr)
head(reset())
head(res)
res
res
res[which(res$lrtest.padj < 0.1),]
res[which(res$summary.padj < 0.1),]
install.packages('MetabolAnalyze')
data1[7:ncol(data1)] = scaling(data1[7:ncol(data1)], type = 'pareto')
library(MetabolAnalyze)
data1[7:ncol(data1)] = scaling(data1[7:ncol(data1)], type = 'pareto')
debugSource('~/Desktop/overfeeding/metabolomics_FC/pareto_scaling.R')
debugSource('~/Desktop/overfeeding/metabolomics_FC/pareto_scaling.R')
debugSource('~/Desktop/overfeeding/metabolomics_FC/pareto_scaling.R')
data1
debugSource('~/Desktop/overfeeding/metabolomics_FC/pareto_scaling.R')
debugSource('~/Desktop/overfeeding/metabolomics_FC/pareto_scaling.R')
data1$X3..cystein.S.yl.acetaminophen.
debugSource('~/Desktop/overfeeding/metabolomics_FC/pareto_scaling.R')
overfeed.data$allopurinol
debugSource('~/Desktop/overfeeding/metabolomics_FC/pareto_scaling.R')
debugSource('~/Desktop/overfeeding/metabolomics_FC/pareto_scaling.R')
debugSource('~/Desktop/overfeeding/metabolomics_FC/pareto_scaling.R')
debugSource('~/Desktop/overfeeding/metabolomics_FC/pareto_scaling.R')
overfeed.data$desmethylnaproxen
debugSource('~/Desktop/overfeeding/metabolomics_FC/pareto_scaling.R')
debugSource('~/Desktop/overfeeding/metabolomics_FC/pareto_scaling.R')
debugSource('~/Desktop/overfeeding/metabolomics_FC/log_univariate.R')
# logitMod2 <- glm(as.formula(paste('TIME.POINT~ AGE + BMI + GENDER + GROUP.NAME + X3..cystein.S.yl.acetaminophen.' )),
logitMod2 <- glm(as.formula(paste('TIME.POINT~ X3..cystein.S.yl.acetaminophen.' )),
data=comb.data, family=binomial(link="logit"))
# logitMod2 <- glm(as.formula(paste('TIME.POINT~ AGE + BMI + GENDER + GROUP.NAME + X3..cystein.S.yl.acetaminophen.' )),
logitMod2 <- glm(as.formula(paste('TIME.POINT~ ', colnames(comb.data)[9])),
data=comb.data, family=binomial(link="logit"))
logitMod2
summary(logitMod2)
logitMod3 <- glm(as.formula(paste(colnames(comb.data)[9], '~ TIME.POINT', )),
data=comb.data, family=binomial(link="logit"))
logitMod3 <- glm(as.formula(paste(colnames(comb.data)[9], '~ TIME.POINT' )),
data=comb.data, family=binomial(link="logit"))
logitMod3 <- glm(as.formula(paste(colnames(comb.data)[9], '~ TIME.POINT' )),
data=comb.data)
summary(logitMod3)
summary(logitMod2)
# logitMod2 <- glm(as.formula(paste('TIME.POINT~ AGE + BMI + GENDER + GROUP.NAME + X3..cystein.S.yl.acetaminophen.' )),
logitMod2 <- glm(as.formula(paste('TIME.POINT~ ', colnames(comb.data)[11])),
data=comb.data, family=binomial(link="logit"))
logitMod3 <- glm(as.formula(paste(colnames(comb.data)[11], '~ TIME.POINT' )),
data=comb.data)
summary(logitMod2)
summary(logitMod3)
debugSource('~/Desktop/overfeeding/metabolomics_FC/log_univariate.R')
debugSource('~/Desktop/overfeeding/metabolomics_FC/log_univariate.R')
debugSource('~/Desktop/overfeeding/metabolomics_FC/log_univariate.R')
source('~/Desktop/overfeeding/metabolomics_FC/log_univariate.R')
debugSource('~/Desktop/overfeeding/metabolomics_FC/log_univariate.R')
BiocManager::install('statTarget')
statAnalysis(comb.data)
library(statTarget)
statAnalysis(comb.data)
library(statTarget)
statAnalysis(comb.data)
statAnalysis('../Re__Obesity_data_set/overfeeding_metabolomics.csv')
debugSource('~/Desktop/overfeeding/metabolomics_FC/log_univariate.R')
debugSource('~/Desktop/overfeeding/metabolomics_FC/log_univariate.R')
data1
?lrtest
debugSource('~/Desktop/overfeeding/metabolomics_FC/log_univariate.R')
lrtest(logitMod, logitMod2)
debugSource('~/Desktop/overfeeding/metabolomics_FC/log_univariate.R')
res
head(res)
debugSource('~/Desktop/overfeeding/metabolomics_FC/log_univariate.R')
res
res[which(res$lrtest.padj < 0.1),]
Q
debugSource('~/Desktop/overfeeding/metabolomics_FC/log_univariate.R')
res[which(res$lrtest.padj < 0.1),]
debugSource('~/Desktop/overfeeding/metabolomics_FC/log_univariate.R')
debugSource('~/Desktop/overfeeding/metabolomics_FC/log_univariate.R')
res
t(res)
head(t(res))
res$lrtest.padj = p.adjust(res$lrtest, method = 'fdr')
res = data.frame(res)
res$lrtest.padj = p.adjust(res$lrtest, method = 'fdr')
res = t(res)
head(res)
res = data.frame(res)
res$lrtest
res$lrtest.padj = p.adjust(res$lrtest, method = 'fdr')
res[which(res$lrtest.padj < 0.1),]
logitMod2
summary(logitMod2)
debugSource('~/Desktop/overfeeding/metabolomics_FC/log_univariate.R')
overfeed.data[1:10,1:3]
overfeed.data[1:3,1:10]
# library(tidyr)
log.overfeed.data = overfeed.data
log.overfeed.data.graph = gather(log.overfeed.data, metabolites, measurement,  7:ncol(log.overfeed.data), factor_key=TRUE)
library(tidyr)
# column_to_rownames(log.overfeed.data, var = '')
log.overfeed.data.graph = gather(log.overfeed.data, metabolites, measurement,  7:ncol(log.overfeed.data), factor_key=TRUE)
ggplot(log.overfeed.data.graph, aes(metabolites, measurement)) +
geom_point()
library(ggplot2)
ggplot(log.overfeed.data.graph, aes(metabolites, measurement)) +
geom_point()
#
log.overfeed.data[,7:ncol(log.overfeed.data)] = log(log.overfeed.data[,7:ncol(log.overfeed.data)], 2)
ggplot(log.overfeed.data.graph, aes(metabolites, measurement)) +
geom_point()
ggplot(log.overfeed.data.graph, aes(metabolites, measurement)) +
geom_point()
log.overfeed.data = overfeed.data
#
log.overfeed.data[,7:ncol(log.overfeed.data)] = log(log.overfeed.data[,7:ncol(log.overfeed.data)], 2)
# column_to_rownames(log.overfeed.data, var = '')
log.overfeed.data.graph = gather(log.overfeed.data, metabolites, measurement,  7:ncol(log.overfeed.data), factor_key=TRUE)
ggplot(log.overfeed.data.graph, aes(metabolites, measurement)) +
geom_point()
max(log.overfeed.data[,7:ncol(log.overfeed.data)])
max(log.overfeed.data[,7:ncol(log.overfeed.data)], na.rm = T)
source('~/Desktop/overfeeding/metabolomics_FC/pareto_scaling.R')
source('~/Desktop/overfeeding/metabolomics_FC/pareto_scaling.R')
source('~/Desktop/overfeeding/metabolomics_FC/pareto_scaling.R')
debugSource('~/Desktop/overfeeding/metabolomics_FC/pareto_scaling.R')
debugSource('~/Desktop/overfeeding/metabolomics_FC/pareto_scaling.R')
debugSource('~/Desktop/overfeeding/metabolomics_FC/pareto_scaling.R')
data1
data1[1:3, 1:10]
debugSource('~/Desktop/overfeeding/metabolomics_FC/pareto_scaling.R')
infCol = c(which(is.infinite(colSums(data1[,7:ncol(data1)]))),which(is.infinite(colSums(data2[,7:ncol(data2)]))))
infCol
colnames(data1)[159]
colnames(data1)[159+7]
colnames(data1)[159+6]
debugSource('~/Desktop/overfeeding/metabolomics_FC/pareto_scaling.R')
res
res
head(res)
head(res)
debugSource('~/Desktop/overfeeding/metabolomics_FC/pareto_scaling.R')
res[which(res$padj < 0.1),]
debugSource('~/Desktop/overfeeding/metabolomics_FC/pareto_univariate.R')
debugSource('~/Desktop/overfeeding/metabolomics_FC/pareto_univariate.R')
debugSource('~/Desktop/overfeeding/metabolomics_FC/pareto_univariate.R')
res
View(res)
# dim(res)
# str(data.frame(res))
# res = do.call(rbind, res)
res = data.frame(t(res))
head(res)
debugSource('~/Desktop/overfeeding/metabolomics_FC/pareto_univariate.R')
debugSource('~/Desktop/overfeeding/metabolomics_FC/pareto_univariate.R')
res
head(res)
res[which(res$lrtest.padj < 0.1),]
res[which(res$summary.padj < 0.1),]
log.overfeed.data.graph = gather(comb.data, metabolites, measurement,  7:ncol(comb.data), factor_key=TRUE)
debugSource('~/Desktop/overfeeding/metabolomics_FC/pareto_univariate.R')
ggplot(log.overfeed.data.graph, aes(metabolites, measurement)) +
geom_point()
comb.data
min(comb.data)
comb.data
min(comb.data[,7:ncol(comb.data)])
debugSource('~/Desktop/overfeeding/metabolomics_FC/pareto_univariate.R')
res[which(res$lrtest.padj < 0.1),]
res[which(res$summary.padj < 0.1),]
res
head(res)
log.overfeed.data.graph = gather(comb.data, metabolites, measurement,  7:ncol(comb.data), factor_key=TRUE)
ggplot(log.overfeed.data.graph, aes(metabolites, measurement)) +
geom_point()
debugSource('~/Desktop/overfeeding/metabolomics_FC/pareto_univariate.R')
debugSource('~/Desktop/overfeeding/metabolomics_FC/pareto_univariate.R')
res
head(res)
debugSource('~/Desktop/overfeeding/metabolomics_FC/pareto_univariate.R')
logitMod2
summary(logitMod2)
debugSource('~/Desktop/overfeeding/metabolomics_FC/pareto_univariate.R')
debugSource('~/Desktop/overfeeding/metabolomics_FC/pareto_univariate.R')
res
head(res)
res[which(res$lrtest.padj < 0.1),]
res[which(res$summary.padj < 0.1),]
head(res)
res$summary.padj
res$summary
sd(c(5,5,5,5,5,15,15,15,15,15))
debugSource('~/Desktop/overfeeding/metabolomics_FC/pareto_scaling.R')
overfeed.data
overfeed.data[1:3,1:10]
overfeed.data[,7:ncol(overfeed.data)] = scaling(overfeed.data[,7:ncol(overfeed.data)], type = 'pareto')
debugSource('~/Desktop/overfeeding/metabolomics_FC/pareto_scaling.R')
debugSource('~/Desktop/overfeeding/metabolomics_FC/pareto_scaling.R')
debugSource('~/Desktop/overfeeding/metabolomics_FC/pareto_scaling.R')
is.infinite(colSums(data1[,7:ncol(overfeed.data)]))
debugSource('~/Desktop/overfeeding/metabolomics_FC/pareto_scaling.R')
debugSource('~/Desktop/overfeeding/metabolomics_FC/pareto_scaling.R')
debugSource('~/Desktop/overfeeding/metabolomics_FC/pareto_scaling.R')
data1
debugSource('~/Desktop/overfeeding/metabolomics_FC/pareto_scaling.R')
overfeed.data
overfeed.data[1:3,1:10]
debugSource('~/Desktop/overfeeding/metabolomics_FC/pareto_scaling.R')
comb.data
debugSource('~/Desktop/overfeeding/metabolomics_FC/pareto_scaling.R')
comb.data
comb.data[,7:ncol(comb.data)] = scale(comb.data[,7:ncol(comb.data)], type = 'pareto')
comb.data[,7:ncol(comb.data)] = scaling(comb.data[,7:ncol(comb.data)], type = 'pareto')
data1 = overfeed.data %>% filter(TIME.POINT == 0)
data2 = overfeed.data %>% filter(TIME.POINT == timepoint)
res = sapply(colnames(data1)[7:ncol(data1)], function(x){
print(x)
test = t.test(data1[,x], data2[,x], paired = TRUE, alternative = "two.sided")
logFC = log(mean(data2[,x])/mean(data1[,x]), 2)
c(LogFC = logFC, p.val = test$p.value)
}
)
res
data1
data1[1:3,1:10]
res
data1[,8]
x = 8
log(mean(data2[,x])/mean(data1[,x]), 2)
data2[,8]
infCol = c(which(is.infinite(colSums(comb.data[,7:ncol(comb.data)]))))
infCol = unique(infCol)
infCol
data1 = data1 %>% select(-c(infCol+6))
debugSource('~/Desktop/overfeeding/metabolomics_FC/pareto_scaling.R')
res
comb.data
is.na(comb.data)
is.na(comb.data) %>% sum()
debugSource('~/Desktop/overfeeding/metabolomics_FC/pareto_scaling.R')
debugSource('~/Desktop/overfeeding/metabolomics_FC/pareto_scaling.R')
data1
data1[,9]
data2[,9]
debugSource('~/Desktop/overfeeding/metabolomics_FC/pareto_scaling.R')
res
head(data1)
res
head(data1)
res
head(data1)
res
head(res)
res$padj = p.adjust(res$p.val, method = 'BH')
res[which(res$padj < 0.1),]
res
head(data1)
res$padj = p.adjust(res$p.val, method = 'BH')
res[which(res$padj < 0.1),]
debugSource('~/Desktop/overfeeding/metabolomics_FC/pareto_scaling.R')
res[which(res$padj < 0.1),]
res[which(res$padj < 0.1),]
res
debugSource('~/Desktop/overfeeding/metabolomics_FC/pareto_scaling.R')
debugSource('~/Desktop/overfeeding/metabolomics_FC/pareto_scaling.R')
res[1:10,1:2]
res$padj = p.adjust(res$p.val, method = 'BH')
res[which(res$padj < 0.1),]
debugSource('~/Desktop/overfeeding/metabolomics_FC/pareto_scaling.R')
comb.data
data1[1:3,1:10]
data1$TIME.POINT
res$padj = p.adjust(res$p.val, method = 'BH')
res[which(res$padj < 0.1),]
res$padj = p.adjust(res$p.val, method = 'fdr')
res[which(res$padj < 0.1),]
res$p.val
res$p.val < 0.1
res[which(res$padj < 0.1),]
res[which(res$padj < 0.1),]
timepoint
debugSource('~/Desktop/overfeeding/metabolomics_FC/pareto_scaling.R')
res[which(res$padj < 0.1),]
debugSource('~/Desktop/overfeeding/metabolomics_FC/pareto_scaling.R')
debugSource('~/Desktop/overfeeding/metabolomics_FC/pareto_scaling.R')
res[which(res$padj < 0.1),]
debugSource('~/Desktop/overfeeding/metabolomics_FC/pareto_univariate.R')
res[which(res$lrtest.padj < 0.1),]
res[which(res$summary.padj < 0.1),]
debugSource('~/Desktop/overfeeding/metabolomics_FC/pareto_univariate.R')
debugSource('~/Desktop/overfeeding/metabolomics_FC/pareto_univariate.R')
res
debugSource('~/Desktop/overfeeding/metabolomics_FC/pareto_univariate.R')
debugSource('~/Desktop/overfeeding/metabolomics_FC/log_univariate.R')
debugSource('~/Desktop/overfeeding/metabolomics_FC/log_univariate.R')
data1
res
t(res)
debugSource('~/Desktop/overfeeding/metabolomics_FC/log_univariate.R')
res[which(res$lrtest.padj < 0.1),]
res[which(res$summary.padj < 0.1),]
debugSource('~/Desktop/overfeeding/metabolomics_FC/log_univariate.R')
debugSource('~/Desktop/overfeeding/metabolomics_FC/log_univariate.R')
res
# dim(res)
# str(data.frame(res))
res = do.call(rbind, res)
res = data.frame((res))
# res = data.frame(t(res))
res[1:10,1:2]
res$lrtest.padj = p.adjust(res$lrtest, method = 'fdr')
res$summary.padj = p.adjust(res$summary, method = 'fdr')
res[which(res$lrtest.padj < 0.1),]
res[which(res$summary.padj < 0.1),]
debugSource('~/Desktop/overfeeding/metabolomics_FC/log_univariate.R')
do.call(rbind, res)
# dim(res)
# str(data.frame(res))
res = do.call(rbind, res)
res = data.frame((res))
# res = data.frame(t(res))
res[1:10,1:2]
str(res)
res$lrtest.padj = p.adjust(res$lrtest, method = 'fdr')
res$summary.padj = p.adjust(res$summary, method = 'fdr')
res[which(res$lrtest.padj < 0.1),]
res[which(res$summary.padj < 0.1),]
debugSource('~/Desktop/overfeeding/metabolomics_FC/log_univariate.R')
res[which(res$lrtest.padj < 0.1),]
res[which(res$summary.padj < 0.1),]
debugSource('~/Desktop/overfeeding/metabolomics_FC/log_univariate.R')
debugSource('~/Desktop/overfeeding/metabolomics_FC/log_univariate.R')
res = data.frame(t(res))
res[1:10,1:2]
str(res)
res$lrtest.padj = p.adjust(res$lrtest, method = 'fdr')
res$summary.padj = p.adjust(res$summary, method = 'fdr')
res[which(res$lrtest.padj < 0.1),]
res[which(res$summary.padj < 0.1),]
debugSource('~/Desktop/overfeeding/metabolomics_FC/log_univariate.R')
res[which(res$lrtest.padj < 0.1),]
res[which(res$summary.padj < 0.1),]
debugSource('~/Desktop/overfeeding/metabolomics_FC/log_univariate.R')
lrtest(logitMod, logitMod2)
lrtest(logitMod2, logitMod)
mcars
mtcars
l1 = glm(mpg~cyl, data = mtcars)
l1 = glm(mpg~cyl+disp, data = mtcars)
l1 = glm(mpg~cyl, data = mtcars)
l2 = glm(mpg~cyl+disp, data = mtcars)
summary(l1)
lrtest(l1, l2)
lrtest(l2,l1)
l3 = glm(mpg~1, data = mtcars)
lrtest(l2,l3)
lrtest(l1,l3)
lrtest(l3,l1)
lrtest(l1)
lrtest(logitMod, logitMod2)
lrtest(logitMod, logitMod2)
lrtest(logitMod, logitMod2)
lrtest(logitMod, logitMod2)
lrtest(logitMod, logitMod2)
lrtest(logitMod, logitMod2)
debugSource('~/Desktop/overfeeding/metabolomics_FC/log_univariate.R')
debugSource('~/Desktop/overfeeding/metabolomics_FC/log_univariate.R')
lrtest(logitMod, logitMod2)
lrtest(logitMod, logitMod2)
source('~/Desktop/overfeeding/metabolomics_FC/log_univariate.R')
source('~/Desktop/overfeeding/metabolomics_FC/log_univariate.R')
